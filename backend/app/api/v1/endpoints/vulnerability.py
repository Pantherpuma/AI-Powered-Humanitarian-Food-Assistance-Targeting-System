"""Vulnerability index endpoints."""

from fastapi import APIRouter, Path

from ....schemas import VulnerabilityScore
from ....services import vulnerability as service

router = APIRouter()


@router.get(
    "/{region_id}",
    response_model=VulnerabilityScore,
    summary="Retrieve AI-derived vulnerability score for a region.",
)
def get_vulnerability(region_id: str = Path(..., description="County or payam identifier.")) -> VulnerabilityScore:
    result = service.score_region(region_id)
    return VulnerabilityScore(
        region_id=result.region_id,
        risk_score=result.risk_score,
        risk_level=result.risk_level,
        indicators=result.indicators,
        feature_contributions=result.feature_contributions,
        updated_at=result.updated_at,
    )

